
const mockResults = {
  header: [{
    value: "a",
    hasResults: true,
  },
  {
    value: "b",
    hasResults: true,
  },
  {
    value: "c",
    hasResults: false,
  },
  {
    value: "d",
    hasResults: true,
  },
  {
    value: "e",
    hasResults: true,
  },
  {
    value: "f",
    hasResults: true,
  },
  {
    value: "g",
    hasResults: true,
  },
  {
    value: "h",
    hasResults: true,
  },
  {
    value: "i",
    hasResults: true,
  },
  {
    value: "j",
    hasResults: false,
  },
  {
    value: "k",
    hasResults: false,
  },
  {
    value: "l",
    hasResults: false,
  },
  {
    value: "m",
    hasResults: false,
  },
  {
    value: "n",
    hasResults: false,
  },
  {
    value: "o",
    hasResults: false,
  },
  {
    value: "p",
    hasResults: false,
  },
  {
    value: "q",
    hasResults: false,
  },
  {
    value: "r",
    hasResults: false,
  },
  {
    value: "s",
    hasResults: false,
  },
  {
    value: "t",
    hasResults: false,
  },
  {
    value: "u",
    hasResults: false,
  },
  {
    value: "v",
    hasResults: false,
  },
  {
    value: "w",
    hasResults: false,
  },
  {
    value: "x",
    hasResults: false,
  },
  {
    value: "y",
    hasResults: false,
  },
  {
    value: "z",
    hasResults: false,
  },

  ],
  results: [{
    key: "a",
    items: [{
      title: 'Açoreana Seguros A',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 2 A',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 A',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "b",
    items: [{
      title: 'Açoreana Seguros B',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 2 B',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 B',
      body: `
              <p>T: +351 213 000 000</p>
              <p>E: info@acoreanaseguros.pt</p>
               `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "d",
    items: [{
      title: 'Açoreana Seguros d',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 2 d',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 d',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "e",
    items: [{
      title: 'Açoreana Seguros E',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 E',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "f",
    items: [{
      title: 'Açoreana Seguros F',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },]
  },
  {
    key: "g",
    items: [{
      title: 'Açoreana Seguros G',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 G',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "h",
    items: [{
      title: 'Açoreana Seguros H',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 H',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },
  {
    key: "i",
    items: [{
      title: 'Açoreana Seguros I',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    },
    {
      title: 'Açoreana Seguros 3 I',
      body: `
      <p>T: +351 213 000 000</p>
      <p>E: info@acoreanaseguros.pt</p>
       `,
      link: {
        title: "Visitar site",
        url: "#",
        target: "_self"
      }
    }

    ]
  },

  ]
}

export const AssociativeComponent = () => {
  // mock data
  const elementsToRender = {
    header: mockResults.header,
    results: mockResults.results[0].items,
  }

  function _handleSearchValue(queryValue, selectedButtonElement) {

    // TODO: Implement ajax call and logic to render only listed 
    const findedIndex = mockResults.results.findIndex(elm => elm.key == queryValue);
    if (findedIndex !== -1) {
      elementsToRender.results = mockResults.results[findedIndex].items;
      document.querySelectorAll('[data-js="search-alphabetic"]')
        .forEach(btnElement => {
          btnElement.classList.remove('active')
        });

      selectedButtonElement.classList.toggle('active');

    }
    _renderResultsSection(elementsToRender.results);
  }

  function _renderElements() {
    elementsToRender.header.forEach((elementData, i) => {
      _renderHeader(elementData, i);
    });

    _renderResultsSection(elementsToRender.results);
  }

  function _renderHeader(elementProps, index) {
    const $ulHeader = document.querySelector('[data-js="associative-component-header"]');
    const $li = document.createElement("li");
    const $button = document.createElement("button");


    $li.classList.add('ac-component_header-li')

    // add .active class for the first result (default active section)
    if (index == 0) {
      $button.classList.add('active');
    }

    if (!elementProps.hasResults) {
      $li.classList.add('without-results')
      $button.setAttribute("disabled", true);
    }

    $button.textContent = elementProps.value.toUpperCase();



    $button.setAttribute("data-js", "search-alphabetic");
    $button.setAttribute("data-js-value", elementProps.value);
    $button.addEventListener("click", (e) => _handleSearchValue(elementProps.value, e.target))

    $li.appendChild($button);
    $ulHeader.appendChild($li);
  }

  function _renderResultsSection(resultsData) {
    const $ulResults = document.querySelector('[data-js="associative-component-results"');
    let $ulHtmlContent = "<ul>";
    resultsData.forEach(result => {
      $ulHtmlContent += `
              <li>
                  <h4 class="heading">${result.title}</h4>
                  <div>
                      ${result.body}
                  </div>
                  <a class="terciary_btn" href="${result.link.url}">${result.title}</a>
              </li>`;

    });
    $ulHtmlContent += "</ul>";


    $ulResults.innerHTML = $ulHtmlContent;
  }


  function init() {
    _renderElements();
  }



  return {
    init,
  }

}